<!DOCTYPE html>
<html lang="ar" dir="rtl">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Ø¥Ø¶Ø§ÙØ© Ø­Ù‚Ù„ ØµÙˆØ± Ø§Ù„ÙØ¦Ø§Øª</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="config.js"></script>
    <script src="database.js"></script>
</head>
<body class="bg-gray-100 p-8">
    <div class="max-w-md mx-auto bg-white rounded-lg shadow-md p-6">
        <h1 class="text-2xl font-bold mb-4">ğŸ”§ Ø¥Ø¶Ø§ÙØ© Ø­Ù‚Ù„ ØµÙˆØ± Ø§Ù„ÙØ¦Ø§Øª</h1>
        <p class="text-gray-600 mb-6">Ù‡Ø°Ù‡ Ø§Ù„ØµÙØ­Ø© ØªÙ‚ÙˆÙ… Ø¨Ø¥Ø¶Ø§ÙØ© Ø­Ù‚Ù„ image_url Ø¥Ù„Ù‰ Ø¬Ø¯ÙˆÙ„ categories ÙÙŠ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª.</p>
        
        <button onclick="addImageColumn()" class="w-full bg-blue-600 text-white py-3 rounded-lg hover:bg-blue-700 font-medium">
            ğŸš€ ØªÙ†ÙÙŠØ° Ø§Ù„ØªØ¹Ø¯ÙŠÙ„
        </button>
        
        <div id="result" class="mt-4"></div>
    </div>

    <script>
        async function addImageColumn() {
            const resultDiv = document.getElementById('result');
            const button = event.target;
            
            button.disabled = true;
            button.textContent = 'Ø¬Ø§Ø±ÙŠ Ø§Ù„ØªÙ†ÙÙŠØ°...';
            resultDiv.innerHTML = '<div class="text-blue-600">Ø¬Ø§Ø±ÙŠ Ø¥Ø¶Ø§ÙØ© Ø§Ù„Ø­Ù‚Ù„ Ø¥Ù„Ù‰ Ù‚Ø§Ø¹Ø¯Ø© Ø§Ù„Ø¨ÙŠØ§Ù†Ø§Øª...</div>';
            
            try {
                // SQL to add the column
                const sql = `
                    ALTER TABLE categories 
                    ADD COLUMN IF NOT EXISTS image_url TEXT;
                    
                    COMMENT ON COLUMN categories.image_url IS 'URL of the category image';
                `;
                
                // Execute the SQL using Supabase RPC
                const response = await fetch(`${SUPABASE_URL}/rest/v1/rpc/exec`, {
                    method: 'POST',
                    headers: {
                        'apikey': SUPABASE_KEY,
                        'Authorization': `Bearer ${SUPABASE_KEY}`,
                        'Content-Type': 'application/json'
                    },
                    body: JSON.stringify({ sql: sql })
                });
                
                if (response.ok) {
                    resultDiv.innerHTML = '<div class="text-green-600">âœ… ØªÙ… Ø¥Ø¶Ø§ÙØ© Ø­Ù‚Ù„ image_url Ø¨Ù†Ø¬Ø§Ø­!</div>';
                    button.textContent = 'âœ… ØªÙ… Ø§Ù„ØªÙ†ÙÙŠØ°';
                    button.classList.remove('bg-blue-600', 'hover:bg-blue-700');
                    button.classList.add('bg-green-600');
                } else {
                    throw new Error(`HTTP ${response.status}: ${response.statusText}`);
                }
                
            } catch (error) {
                console.error('Error adding column:', error);
                resultDiv.innerHTML = `<div class="text-red-600">âŒ Ø®Ø·Ø£: ${error.message}</div>`;
                button.disabled = false;
                button.textContent = 'ğŸ”„ Ø¥Ø¹Ø§Ø¯Ø© Ø§Ù„Ù…Ø­Ø§ÙˆÙ„Ø©';
            }
        }
    </script>
</body>
</html>
